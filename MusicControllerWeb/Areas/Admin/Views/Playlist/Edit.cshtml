@model PlaylistwithTrackViewModel
@{
    ViewData["Title"] = "AddTrack";
}

<div class="container row">
    <div class="col-sm-6 border p-5">
        <h4 class="">Edit Playlist</h4><br />
        <form asp-action="Edit" onsubmit="return onSubmitClick(this);" asp-route-id="@Model.Playlist.Id">
            <input type="hidden" asp-for="Playlist.OutletId" />
            <div class="form-group">
                <label asp-for="Playlist.Name" for="name"></label>
                <input type="text" asp-for="Playlist.Name" class="form-control" placeholder="Enter name">
                <span asp-validation-for="Playlist.Name" class="text-danger"></span>
            </div>
            <div class="form-group">
                <label for="schedule">Playlist Schedule:</label><br />
                <select class="form-control" asp-for="Playlist.Schedule" id="schedule">
                    <option disabled selected>Please Select</option>
                    <option value="@Schedule.Daily">Daily</option>
                    <option value="@Schedule.AlternativeDay">Alternate Days</option>
                    <option value="@Schedule.Weekly">Weekly</option>
                    <option value="@Schedule.Monthly">Monthly</option>
                    <option value="@Schedule.Yearly">Yearly</option>
                </select>
                <span asp-validation-for="Playlist.Schedule" class="text-danger"></span>
            </div>
            <div class="form-group" id="evenOrdays" style="display:none;">
                <label for="sel3">Even or Odd Days?</label>
                <select class="form-control" asp-for="Playlist.Frequency" id="evenOrday">
                    <option disabled selected>Please Select</option>
                    <option value="Even Days">Even Days</option>
                    <option value="Odd Days">Odd Days</option>
                </select>
                <span id="errevenOrday" class="text-danger" style="display:none;">Please select Frequency</span>
            </div>

            <div class="form-group" id="weekdays" style="display:none;">
                <label for="sel1">Which day?</label>
                <select class="form-control" asp-for="Playlist.Frequency" id="weekday">
                    <option disabled selected>Please Select</option>
                    <option value="Monday">Monday</option>
                    <option value="Tuesday">Tuesday</option>
                    <option value="wednesday">Wednesday</option>
                    <option value="Thursday">Thursday</option>
                    <option value="Friday">Friday</option>
                    <option value="Saturday">Saturday</option>
                    <option value="Sunday">Sunday</option>
                </select>
            </div>

            <div class="form-group" id="specificDates" style="display:none;">
                <label for="sel2">Which Date?</label>
                <input type="date" asp-for="Playlist.Frequency" class="form-control" id="specificDate">
            </div><br />
            <button type="submit" class="btn btn-success">Save</button>
        </form>
    </div>
    <div class="col-sm-6 border p-5">
        <h4>Add Track</h4><br />
        <form asp-action="AddTrack" asp-route-id="@Model.Playlist.Id">
            <div asp-validation-summary="ModelOnly" class="text-danger">
            </div>
            <input asp-for="AddTrack.PlaylistId" name="PlaylistId" value="@Model.Playlist.Id" type="hidden" />
            <div class="form-group">
                <label asp-for="AddTrack.TrackURL"></label>
                <input asp-for="AddTrack.TrackURL" name="TrackURL" placeholder="Enter Track Url" class="form-control">
                <span asp-validation-for="AddTrack.TrackURL" class="text-danger"></span>
            </div>
            <div class="form-group">
                <label asp-for="AddTrack.StartTime"></label>
                <input asp-for="AddTrack.StartTime" name="StartTime" class="form-control" placeholder="Enter Start Time">
                <span asp-validation-for="AddTrack.StartTime" class="text-danger"></span>
            </div>
            <div class="form-group">
                <label asp-for="AddTrack.EndTime"></label>
                <input asp-for="AddTrack.EndTime" name="EndTime" class="form-control" placeholder="Enter End Time">
                <span asp-validation-for="AddTrack.EndTime" class="text-danger"></span>
            </div>
            <br />
            <button type="submit" class="btn btn-primary">Add Track</button>
        </form>
    </div>
</div>
<div class="col-md-12">
    <h5>Tracks:</h5><br />
    <div class="list-group" id="myList">
        @foreach (var item in Model.Playlist.Tracks)
        {
            <a href="#" class="list-group-item text-body text-decoration-none">
                <div class="row">
                    <div class="col-sm-10 align-content-center h-100">
                        <span class="text-primary"> @item.TrackURL<br /> </span>
                        <small>Start Time: @item.StartTime</small><br />
                        <small>End Time: @item.EndTime</small><br />
                    </div>
                    <div class="col-sm-2 align-content-end">
                        <div class="form-inline">
                            <button class="btn btn-outline-primary btn-sm mr-2" onclick="location.href='@Url.Action("Edit", "Tracks", new { id = item.Id,area="Admin" })'"> Edit </button>
                            <form asp-action="Delete" asp-controller="Tracks" asp-route-id="@item.Id">
                                <input type="hidden" name="playlistId" value="@item.PlaylistId" />
                                <button type="submit" class="btn btn-outline-danger btn-sm">Remove</button>
                            </form>
                        </div>
                    </div>
                </div>

            </a><br />
        }
    </div>
</div>

@section Scripts {
    @{await Html.RenderPartialAsync("_ValidationScriptsPartial");}
    @{await Html.RenderPartialAsync("_ValidationScriptsPartial");}
<script>
        $(window).on('load', function () {
            var value = "@Model.Playlist.Schedule";
            switch (value) {
                case "@Schedule.Daily":
                    $("#specificDates").hide();
                    $("#weekdays").hide();
                    $("#evenOrdays").hide();
                    $("#weekday").prop('required', false);
                    break;
                case "@Schedule.AlternativeDay":
                    $("#specificDates").hide();
                    $("#weekdays").hide();
                    $("#evenOrdays").show();
                    $("#evenOrday").prop('required', true);
                    break;
                case "@Schedule.Monthly":
                    $("#specificDates").hide();
                    $("#weekdays").hide();
                    $("#evenOrdays").hide();
                    $("#evenOrday").prop('required', false);
                    break;
                case "@Schedule.Weekly":
                    $("#specificDates").hide();
                    $("weekday").prop('required', true);
                    $("#weekdays").show();
                    $("#evenOrdays").hide();
                    break;
                default:
            }
        });
        // todo: dailt no frequncy
        $("#schedule").change(function () {
            switch (this.value) {
                case "@Schedule.Daily":
                    $("#specificDates").hide();
                    $("#weekdays").hide();
                    $("#evenOrdays").hide();
                    $("#weekday").prop('required', false);
                    break;
                case "@Schedule.AlternativeDay":
                    $("#specificDates").hide();
                    $("#weekdays").hide();
                    $("#evenOrdays").show();
                    $("#evenOrday").prop('required', true);
                    break;
                case "@Schedule.Monthly":
                    $("#specificDates").hide();
                    $("#weekdays").hide();
                    $("#evenOrdays").hide();
                    $("#evenOrday").prop('required', false);
                    break;
                case "@Schedule.Weekly":
                    $("#specificDates").hide();
                    $("weekday").prop('required', true);
                    $("#weekdays").show();
                    $("#evenOrdays").hide();
                    break;
                default:
            }
        });

        function onSubmitClick(item) {
            console.log(item);
            var schedule = item.schedule.value
            debugger;
            if (item.schedule.value == "@Schedule.AlternativeDay" && item.evenOrday.value=="" ) {
                $("#errevenOrday").show();
                return false;
            }
            return true;
        }
</script>
}
